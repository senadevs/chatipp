import{j as e}from"./jsx-runtime.D_zvdyIk.js";import{r as c}from"./index.C-1C7K5d.js";import{C as z,H as P,t as A,F as M,M as H,r as G,a as O,B as K,b as Y,c as _,d as $,e as q,f as U,I as V,P as T,S as W,g as J,h as k}from"./hover-card.CxF68cKK.js";import{B as v,c as x,u as Q,a as X}from"./button.DB3euxDd.js";import{C as Z,a as ee}from"./index.CmoEq9BJ.js";import{I as se}from"./input.D_t8jYCD.js";import"./index.DogxjsyZ.js";import"./createLucideIcon.CXgODOBx.js";import"./index.BeJBZjGA.js";function te({language:s,children:r}){const[a,n]=c.useState(!1),p=()=>{navigator.clipboard.writeText(r),n(!0),setTimeout(()=>n(!1),2e3)};return e.jsxs("div",{className:"relative group",children:[e.jsx(v,{variant:"ghost",size:"icon",className:"absolute right-2 top-2 opacity-0 group-hover:opacity-100 transition-opacity",onClick:p,children:a?e.jsx(Z,{className:"h-4 w-4 text-green-500"}):e.jsx(z,{className:"h-4 w-4"})}),e.jsx(P,{theme:A.nightOwl,code:r.trim(),language:s||"text",children:({className:l,style:m,tokens:o,getLineProps:i,getTokenProps:f})=>e.jsxs("pre",{className:"overflow-x-auto p-4 rounded-lg",style:{...m,backgroundColor:"var(--code-bg)",marginTop:"1rem",marginBottom:"1rem"},children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{style:{color:"var(--code-meta)",fontSize:"0.875rem"},children:s})}),o.map((g,j)=>e.jsxs("div",{...i({line:g}),style:{display:"table-row"},children:[e.jsx("span",{style:{display:"table-cell",paddingRight:"1rem",color:"var(--code-line-number)",userSelect:"none",width:"1%",whiteSpace:"nowrap"},children:j+1}),e.jsx("span",{style:{display:"table-cell"},children:g.map((N,w)=>e.jsx("span",{...f({token:N})},w))})]},j))]})})]})}function ae({attachment:s}){switch(s.type){case"image":return e.jsx("div",{className:"mt-2 rounded-lg overflow-hidden max-w-sm",children:e.jsx("img",{src:s.url,alt:"attachment",className:"w-full h-auto"})});case"pdf":return e.jsx("div",{className:"mt-2",children:e.jsxs("a",{href:s.url,target:"_blank",rel:"noopener noreferrer",className:"flex items-center gap-2 p-2 rounded-md bg-muted hover:bg-muted/80 transition-colors",children:[e.jsx(M,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:s.name})]})});case"video":return e.jsx("div",{className:"mt-2 max-w-sm",children:e.jsxs("video",{controls:!0,className:"w-full rounded-lg",children:[e.jsx("source",{src:s.url,type:"video/mp4"}),"Your browser does not support the video tag."]})});case"audio":return e.jsx("div",{className:"mt-2",children:e.jsxs("audio",{controls:!0,className:"w-full",children:[e.jsx("source",{src:s.url,type:"audio/mpeg"}),"Your browser does not support the audio tag."]})});default:return null}}function re({message:s,isSelected:r}){return e.jsx("div",{id:`message-${s.id}`,className:x("flex w-full transition-colors duration-300 rounded-lg p-2",s.sender==="user"?"justify-end":"justify-start",r&&"bg-accent/50"),children:e.jsxs("div",{className:x("rounded-lg px-4 py-2 max-w-[90%] transition-all",s.sender==="user"?"bg-primary text-primary-foreground":"bg-muted"),children:[s.sender==="bot"?e.jsx("div",{className:"markdown-content",children:e.jsx(H,{remarkPlugins:[G],components:{code:({node:a,inline:n,className:p,children:l,...m})=>{if(n)return e.jsx("code",{className:"bg-muted px-1.5 py-0.5 rounded-md text-sm",...m,children:l});const o=/language-(\w+)/.exec(p||""),i=o?o[1]:"text";return e.jsx(te,{language:i,children:String(l).replace(/\n$/,"")})}},children:s.content})}):e.jsxs(e.Fragment,{children:[e.jsx("p",{className:"text-sm break-words",children:s.content}),s.attachments?.map((a,n)=>e.jsx(ae,{attachment:a},n))]}),e.jsx("span",{className:"text-xs opacity-50 mt-1 block",children:s.timestamp.toLocaleTimeString()})]})})}function ne({mode:s,onModeChange:r}){return e.jsxs("div",{className:"relative inline-flex h-9 rounded-full border bg-muted p-1 hover:bg-muted/80",children:[e.jsx("button",{className:x("relative inline-flex items-center gap-2 rounded-full px-3 text-sm transition-colors",s==="chat"?"bg-background text-foreground shadow-sm":"text-muted-foreground"),onClick:()=>r("chat"),children:e.jsx(O,{className:"h-4 w-4"})}),e.jsx("button",{className:x("relative inline-flex items-center gap-2 rounded-full px-3 text-sm transition-colors",s==="agent"?"bg-background text-foreground shadow-sm":"text-muted-foreground"),onClick:()=>r("agent"),children:e.jsx(K,{className:"h-4 w-4"})})]})}const le=[{value:"gpt-4",label:"GPT-4",description:"Most capable model, best for complex tasks",icon:"âœ¨"},{value:"gpt-3.5-turbo",label:"GPT-3.5",description:"Fast and efficient for most tasks",icon:"âš¡"},{value:"gemini-pro",label:"Gemini",description:"Google's most advanced AI model",icon:"ðŸŒŸ"},{value:"claude-3",label:"Claude 3",description:"Exceptional at analysis and writing",icon:"ðŸŽ¯"},{value:"mistral-large",label:"Mistral",description:"Open-source model with strong capabilities",icon:"ðŸš€"},{value:"mixtral-8x7b",label:"Mixtral",description:"Powerful open-source mixture of experts",icon:"ðŸ”®"}];function oe({selectedModel:s,onModelSelect:r}){return e.jsx("div",{className:"flex flex-wrap gap-2",children:le.map(a=>e.jsxs(Y,{children:[e.jsx(_,{asChild:!0,children:e.jsxs("button",{onClick:()=>r(a.value),className:x("inline-flex items-center justify-center rounded-full px-3 py-1 text-sm transition-colors",s===a.value?"bg-primary text-primary-foreground shadow-sm":"bg-muted text-muted-foreground hover:bg-muted/80"),children:[e.jsx("span",{className:"mr-1",children:a.icon}),a.label]})}),e.jsx($,{className:"w-64",children:e.jsx("div",{className:"flex justify-between space-x-4",children:e.jsxs("div",{className:"space-y-1",children:[e.jsx("h4",{className:"text-sm font-semibold",children:a.label}),e.jsx("p",{className:"text-sm text-muted-foreground",children:a.description})]})})})]},a.value))})}function ie({file:s,type:r}){const a={image:e.jsx(V,{className:"h-5 w-5"}),"application/pdf":e.jsx(M,{className:"h-5 w-5"}),video:e.jsx(U,{className:"h-5 w-5"}),audio:e.jsx(q,{className:"h-5 w-5"})}[r.split("/")[0]]||e.jsx(T,{className:"h-5 w-5"});return e.jsxs("div",{className:"flex items-center gap-2 p-2 rounded-md bg-muted",children:[a,e.jsx("span",{className:"text-sm truncate max-w-[200px]",children:s.name})]})}function ce({value:s,onChange:r,onSend:a,onKeyPress:n,onFileSelect:p,files:l,isPublic:m}){const o=c.useRef(null);return e.jsxs("div",{className:"space-y-4",children:[l.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2",children:l.map((i,f)=>e.jsx(ie,{file:i,type:i.type},f))}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{placeholder:m?"Send a message as guest...":"Type a message...",value:s,onChange:i=>r(i.target.value),onKeyDown:n,className:"flex-1"}),!m&&e.jsxs(e.Fragment,{children:[e.jsx("input",{type:"file",ref:o,onChange:p,multiple:!0,accept:"image/*,application/pdf,video/*,audio/*",className:"hidden"}),e.jsx(v,{variant:"outline",size:"icon",onClick:()=>o.current?.click(),children:e.jsx(T,{className:"h-4 w-4"})})]}),e.jsx(v,{onClick:a,size:"icon",children:e.jsx(W,{className:"h-4 w-4"})})]}),m&&e.jsxs("p",{className:"text-xs text-muted-foreground text-center",children:[e.jsx("a",{href:"/login",className:"text-primary hover:underline",children:"Sign in"})," ","to send files and access all features"]})]})}function be({isPublic:s=!1}){const[r,a]=c.useState([]),[n,p]=c.useState(""),[l,m]=c.useState(!1),[o,i]=c.useState([]),{toast:f}=Q(),g=c.useRef(null),{isAuthenticated:j}=X(),[N,w]=c.useState(null),[y,I]=c.useState("chat"),[S,F]=c.useState("gpt-4"),D=()=>{g.current&&g.current.scrollIntoView({behavior:"smooth"})};c.useEffect(()=>{D()},[r]);const E=t=>{if(!j){f({title:"Authentication Required",description:"Please login to send files",variant:"destructive"});return}const u=Array.from(t.target.files||[]);if(u.reduce((h,b)=>h+b.size,0)>50*1024*1024){f({title:"Error",description:"Total file size cannot exceed 50MB",variant:"destructive"});return}i(h=>[...h,...u])},C=async()=>{if(!n.trim()&&o.length===0)return;const t=new FormData;t.append("message",n.trim()),t.append("mode",y),t.append("model",S),j&&o.forEach(d=>t.append("files",d));const u={id:Date.now().toString(),content:n.trim(),sender:"user",timestamp:new Date,attachments:j?o.map(d=>({type:d.type.split("/")[0],url:URL.createObjectURL(d),name:d.name})):void 0};a(d=>[...d,u]),p(""),i([]);try{const h=await(await fetch("/api/chat",{method:"POST",body:t})).json(),b={id:(Date.now()+1).toString(),content:h.message||"Lo siento, hubo un error en la respuesta.",sender:"bot",timestamp:new Date};a(R=>[...R,b])}catch{const h={id:(Date.now()+1).toString(),content:"Lo siento, hubo un error en la conexiÃ³n.",sender:"bot",timestamp:new Date};a(b=>[...b,h])}},B=t=>{t.key==="Enter"&&!t.shiftKey&&(t.preventDefault(),C())},L=t=>{w(t);const u=document.getElementById(`message-${t}`);u&&(u.scrollIntoView({behavior:"smooth",block:"center"}),u.classList.add("bg-accent/50"),setTimeout(()=>{u.classList.remove("bg-accent/50")},2e3))};return e.jsxs("div",{className:"h-[calc(100vh-8rem)] w-full flex bg-background relative rounded-lg border",children:[e.jsx("div",{className:x("bg-card border-r border-border transition-all duration-300 ease-in-out",l?"w-12":"w-64","relative h-full"),children:e.jsxs("div",{className:"flex flex-col h-full",children:[e.jsxs("div",{className:"p-3 border-b border-border flex items-center justify-between",children:[e.jsx("h2",{className:x("font-semibold text-sm",l&&"hidden"),children:"Chat History"}),e.jsx(v,{variant:"ghost",size:"icon",onClick:()=>m(!l),className:"h-8 w-8",children:l?e.jsx(ee,{className:"h-4 w-4"}):e.jsx(J,{className:"h-4 w-4"})})]}),e.jsx(k,{className:"flex-1",children:e.jsxs("div",{className:"p-2 space-y-1",children:[r.map(t=>e.jsx(v,{variant:"ghost",className:x("w-full justify-start text-left p-2 h-auto",l&&"hidden",N===t.id&&"bg-accent"),onClick:()=>L(t.id),children:e.jsxs("div",{className:"flex flex-col gap-1 w-full",children:[e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{className:"text-xs text-muted-foreground",children:t.timestamp.toLocaleTimeString()}),e.jsx("span",{className:"text-xs font-medium",children:t.sender==="user"?"You":"Bot"})]}),e.jsxs("p",{className:"text-sm truncate",children:[t.content.substring(0,30),t.content.length>30&&"..."]})]})},t.id)),r.length===0&&e.jsx("p",{className:x("text-sm text-muted-foreground p-2",l&&"hidden"),children:"No messages yet"})]})})]})}),e.jsxs("div",{className:"flex-1 flex flex-col",children:[e.jsx(k,{className:"flex-1 px-4",children:e.jsxs("div",{className:"max-w-3xl mx-auto py-4 space-y-6",children:[r.length===0&&e.jsxs("div",{className:"text-center text-muted-foreground",children:[e.jsx("p",{className:"text-lg",children:"Welcome to the chat!"}),e.jsx("p",{className:"text-sm",children:"Start a conversation by sending a message."})]}),r.map(t=>e.jsx(re,{message:t,isSelected:N===t.id},t.id)),e.jsx("div",{ref:g})]})}),e.jsx("div",{className:"p-4 border-t border-border bg-background/95 backdrop-blur supports-[backdrop-filter]:bg-background/60",children:e.jsxs("div",{className:"max-w-3xl mx-auto space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-2",children:[e.jsx(ne,{mode:y,onModeChange:I}),e.jsx(oe,{selectedModel:S,onModelSelect:F})]}),e.jsx(ce,{value:n,onChange:p,onSend:C,onKeyPress:B,onFileSelect:E,files:o,isPublic:s})]})})]})]})}export{be as default};
